## Part 1. Установка ОС

- Скачиваем и устанавливаем **Ubuntu 20.04 Server LTS** без графического интерфейса.
- Для просмотра версии **Ubuntu** выполняем команду `cat /etc/issue`.\
  ![](img_report/1-linux_vers.png)

## Part 2. Создание пользователя
- Создаем нового пользователя командой `sudo adduser <user name>`\
  ![](img_report/2-add_user.png)
- Добавление пользователя в группу adm:\
  ![](img_report/2-addadm_user.png)
- Проверка нового пользователя выполняется командой `cat /etc/passwd`\
  ![](img_report/2-new_user.png)

## Part 3. Настройка сети ОС
- Открываем в текстовом редакторе файлы с названием машины и изменяем его:\
 `sudo vim /etc/hostname`\
  `sudo vim /etc/hosts`\
  Изменяем имя машины на user-1, сохраняем файлы и перезапускаем машину.\
  ![](img_report/3-user-1.png)
- Перед сменой часового пояса вам нужно узнать длинное имя часового пояса, которое вы хотите использовать.
  Часовые пояса используют формат «Регион/Город».
  Чтобы вывести список всех доступных часовых поясов, вы можете либо перечислить файлы в каталоге /usr/share/zoneinfo,
  либо вызвать команду timedatectl с опцией list-timezones:
  `timedatectl list-timezones`.
- Для смены часового пояса приминяестя команда: `sudo timedatectl set-timezone your_time_zone`.
  В данном случае использовался часовой пояс `Europe/Moscow`.
  Что бы проверить изменения, вызывается команда `timedatectl`.
  ![](img_report/3-time_zone.png)
- Для вызова списка названий сетевых интерфейсов используется команда `ifconfig`.
  Данная команда предварительно не установлена в Ubuntu 20.04 Server LTS, установите пакет net-tools при помощи команды
  `sudo apt install net-tools`.
  ![](img_report/3-list_of_network_interfaces.png)
- lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux.
  Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине.
  С этим интерфейсом всегда связан адрес 127.0.0.1. У него есть dns-имя – localhost.
- Для полученя ip адрес устройства, на котором вы работаете, от DHCP сервера использую команду `sudo dhcpcd -h enp0s3`
  предворительно воспользовавшись командой `sudo apt install dhcpcd5`.\
  ![](img_report/3-ip_dhcp.png)
- DHCP (англ. Dynamic Host Configuration Protocol — протокол динамической настройки узла) —
  прикладной протокол, позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры,
  необходимые для работы в сети TCP/IP. Данный протокол работает по модели «клиент-сервер».
  Для автоматической конфигурации компьютер-клиент на этапе конфигурации сетевого устройства обращается
  к так называемому серверу DHCP и получает от него нужные параметры.

- Что бы отобразить внутрений ip-адрес шлюза можно использовать номанду `ip r`\
![](img_report/3-ip.png)
- Что бы отобразить внешний ip-адрес шлюза использутся команда `wget eth0.me -gO -`\
![](img_report/3-gw.png)
- Что бы задать (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8) открываем файл по команде `sudo vim /etc/netplan/00-installer-config.yaml` и изменяем настройки:\
![](img_report/3-new_ip.png)
далее отключаем dhcp командой `systemctl stop dhcpcd` и применяем изменения командой `sudo systemctl restart`.

- Пропингуем удаленные хосты:\
  ![](img_report/3-ping.png)

## Part 4. Обновление ОС
- Обновить системные пакеты до последней можно применив команды:\
`sudo apt-get update`\
`sudo apt-get upgrade`.
- При повторном вводе ввыводится сообщение:\
  ![](img_report/4-upgrade.png)

## Part 5. Использование команды sudo
- Команда sudo ( substitute user and do, подменить пользователя и выполнить ) позволяет строго определенным
  пользователям выполнять указанные программы с административными привилегиями без ввода пароля суперпользователя root.
- Что бы дать ползователю разрешение на выполнение команды `sudo` вводится команда `sudo usermod -aG sudo <user name>`\
  Для смены пользователя выполняется команда `su - <name>`\
  ![](img_report/5-user.png)
- Изменяем hostname как это делали в [Part 3](#part-3-настройка-сети-oc)\
  Результат изменения hostname:\
  ![](img_report/5-new_hostname.png)

## Part 6. Установка и настройка службы времени
- Проверяем время командой `timedatectl`:\
  ![](img_report/6-time.png)
- Проверяем работу автоматической синхронизации времени командой `timedatectl show`:
  ![](img_report/6-time_show.png)

## Part 7. Установка и использование текстовых редакторов
- Для установки текстового редактора используется команда `sudo apt install <name of the text editor>`
- Используя каждый из трех выбранных редакторов, создайте файл test_X.txt, где X -- название редактора,
  в котором создан файл. Напишите в нём свой никнейм, закройте файл с сохранением изменений.
    - VIM:\
      ![](img_report/7-vim.png)\
      Для выхода с сохранением нажимаем `Esc` и вводим `:wq`, после чего нажимаем `Enter`.
    - NANO:\
      ![](img_report/7-nano.png)\
      Для выхода с сохранением нажимаем `ctrl + X`, затем подверждаем `Y` и `Enter`.
    - JOE:\
      ![](img_report/7-joe.png)\
      Для выхода с сохранением нажимаем `ctrl + K`, `Q` и `Y`
- Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл,
  заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.
    - VIM:\
      ![](img_report/7-vim2.png)\
      Для выхода без сохранения нажимаем `Esc` и вводим `:q!`, после чего нажимаем `Enter`.
    - NANO:\
      ![](img_report/7-nano2.png)\
      Для выхода без сохранения сохранением нажимаем `ctrl + X`, затем подверждаем `N``.
    - JOE:\
      ![](img_report/7-joe2.png)\
      Для выхода без сохранения сохранением нажимаем `ctrl + K`, `Q` и `N`
- Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом),
  а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.
    - VIM:\
      поиск элемента пройсходит путем перехода из обычного режима в режим пойска нажатием `/`:
      ![](img_report/7-vim3_1.png)
      для замены элемента используют команду `:s/.../.../`\
      ![](img_report/7-vim3_2.png)
    - NANO:
      для поиска используют сочетание клавишь `Ctrl + W`
      ![](img_report/7-nano3_1_1.png)
      ![](img_report/7-nano3_1_2.png)
      для замены элемента используют сочетание клавишь `Ctrl + W` и `Ctrl + R`, после чего вводится то, что заменяется, после нажатие на `Enter` водится вводится новая строка, подвержаетя `Enter` и соглашается клавишей `Y`
      ![](img_report/7-nano3_2_1.png)
      ![](img_report/7-nano3_2_2.png)

## Part 8. Установка и базовая настройка сервиса SSHD

- Для установки службы SSHd приминяется следующая команда `sudo apt-get install ssh`
- Для добавления автостарта службы при загрузке системы используется команда `sudo systemctl enable ssh`\
  ![](img_report/8-astart.png)
- Для смены порта необходимо заменить порт на нужный в 
  файле sshd_config сохранить изменения и перезапрустить домен SSH.\
  `sudo vim /etc/ssh/sshd_config`\
  ![](img_report/8-port_2022.png)
  `sudo systemctl restart sshd`
- Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.\
  `ps -C sshd`\
  ![](img_report/8-ps.png)
  Команда ps выводит список текущих процессов на сервере. Опция C фильтрует процессы по указанной строке.
- Перезагрузка системы происходит командой  `sudo reboot`
- Вывод команды `netstat -tan`\
  ![](img_report/8-netstat.png)
  - Значение ключей -tan:\
    -t - Отображение текущего подключения в состоянии переноса нагрузки с процессора на сетевой адаптер при передаче данных ( "offload" ).\
    -a - Отображение всех подключений и ожидающих портов.\
    -n - Отображение адресов и номеров портов в числовом формате.
  - Значение каждого столбца вывода:
    - Proto - название протокола
    - Recv-Q - cчётчик байт не скопированных программой пользователя из - этого сокета
    - Send-Q - счётчик байтов, не подтверждённых удалённым узлом
    - Local Address - адрес и номер порта локального конца сокета
    - Foreign Address - адрес и номер порта удалённого конца сокета
    - Status - состояние соединение\
    Виды соединений:
    - ESTABLISHED - соединение установлено
    - SYN_SENT - сокет пытается установить соединение
    - SYN_RECV - начальная синхронизация соединения
    - FIN_WAIT1 - сокет закрыт, ожидание отключения соединения
    - FIN_WAIT2 - ожидание отключения удаленной стороны
    - TIME_WAIT - ожидание после закрытия повторной передачи отключения удаленной стороны
    - CLOSED - соединение закрыто, сокет не используется
    - CLOSE_WAIT - удаленный узел отключился, сокет скоро будет закрыт
    - LAST_ACK - сначала отключилась удаленная сторона, а затем сокет будет закрыт
    - LISTEN - сокет ожидает входящих соединений
    - CLOSING - закрытие сокета, точнее сокет закрыт, а затем отключился удаленный узел
    - UNKNOWN - состояние сокета неизвестно.
  - Значение 0.0.0.0 означает - "любой адрес"

## Part 9. Установка и использование утилит top, htop
- Вывод команды `top`\
 ![](img_report/9-top.png)
  - uptime - 4 min
  - количество авторизованных пользователей - 1
  - общую загрузку системы - 0.06 0.25 0.14
  - общее количество процессов - 106
  - загрузку cpu - 0
  - загрузку памяти - 976,9
  - pid процесса занимающего больше всего памяти - 1
  - pid процесса, занимающего больше всего процессорного времени - 1
- Вывод команды htop: \
  - Отсортированный по PID\
    ![](img_report/9-htop_pid.png)
  - Отсортированный по PERCENT_CPU\
    ![](img_report/9-htop_cpu.png)
  - Отсортированный по PERCENT_MEM\
    ![](img_report/9-htop_mem.png)
  - Отсортированный по TIME\
    ![](img_report/9-htop_time.png)
  - Отфильтрованному для процесса sshd\
    ![](img_report/9-htop_sshd.png)
  - С процессом syslog, найденным, используя поиск\
    ![](img_report/9-htop_syslog.png)
  - С добавленным выводом hostname, clock и uptime\
    ![](img_report/9-htop_add.png)

## Part 10. Использование утилиты fdisk
- Вывод команды `sudo fdisk -l`\
  ![](img_report/10-fdisk.png)
- Название жесткого диска - sda
- Размер - 10GiB
- Количество секторов - 20971520
- Размер swap - 1,5G\
  ![](img_report/10-swap.png)

## Part 11. Использование утилиты df
- Запуск команды `df`\
  ![](img_report/11-df.png)
- Данные для корневого раздела (/):
  - размер раздела - 8408452 KiB
  - размер занятого пространства - 4464976 KiB
  - размер свободного пространства - 3943476 KiB
  - процент использования - 57%
  - The 1K block in GNU coreutils df(1) means 1024 bytes
- Запуск команды `df -Th`\
  ![](img/11-df-th.png)
  ![](img_report/11-df-th.png)
- Данные для корневого раздела (/):
  - размер раздела - 8.1G
  - размер занятого пространства - 4.3G
  - размер свободного пространства - 3.8G
  - процент использования - 57%
  - тип файловой системы - ext4

## Part 12. Использование утилиты du
- Запуск команды `du`\
  ![](img_report/12-du.png)
- Вывод размера всего содержимого в /var/log\
  ![](img_report/12-du_log.png)

## Part 13. Установка и использование утилиты ncdu
- Для установки утилиты ncdu используется команда `sudo apt-get install ncdu`
- Что бы запустить утилиту выполняеися команда `sudo ncdu /`\
  После сканирования используем клавишу i на необходимом нам каталоге.
- home:\
  ![](img_report/13-ncdu_home.png)
- var:\
  ![](img_report/13-ncdu_var.png)
- var/log:\
  ![](img_report/13-ncdu_var_log.png)

## Part 14. Работа с системными журналами
- Информация о последней успешной авторизации можно отследить выполнив команду `sudo vim /var/log/auth.log`\
  ![](img_report/14-auth_log.png)
- Время последней успешной авторизации: 03:05:08.
- Выполнить рестарт sshd командой `sudo systemctl restart sshd`
- Информация о рестарте службы можно найти выполнив команду `sudo vim /var/log/syslog`\
  ![](img_report/14-restarting.png)

## Part 15. Использование планировщика заданий CRON
- Что бы запустиь команду uptime через каждые 2 минуты, используя планировщик заданий, нужно выполнить команду `crontab -e` и добавить задачу\
  ![](img_report/15-crontab-e.png)
- Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении\
  ![](img_report/15-cron_uptime.png)
- Список текущих заданий для CRON выводится командой `crontab -l`
  ![](img_report/15-crontab-l.png)
- Удаление всех заданий и з планировщика заданий выполняется командой `crontab -r`\
Список текущих заданий после удаления:\
  ![](img_report/15-crontab-r.png)